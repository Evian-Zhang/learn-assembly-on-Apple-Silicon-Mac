# 内存交互

目前我们所叙述的赋值指令、数据处理指令，都是在寄存器层面进行的。那么，如何与内存进行交互呢？

## C语言层面的内存

首先我们需要知道，为什么要与内存交互。在[硬件基础](./3-硬件基础.md)中我们提到，理论上，如果我们有能力CPU直连几十上百万个寄存器，那么是不需要内存的。从另一个层面来讲，如果我们能做到内存与CPU之间的读取速度和寄存器类似，那么我们也不需要寄存器了。也就是说，内存以量取胜，寄存器以速度取胜。我们在编程中的变量动辄成千上百个，都存储在寄存器中也就因此不现实。

因此，我们在C语言中使用的**变量**，默认情况下往往都是存储在内存中的。但是，当我们涉及到具体的数据处理等等指令的时候，其必须操作寄存器。所以，我们在操作变量的过程中，底层实际上首先都是需要将变量对应的内存中的值传入寄存器的。因此，这里就涉及到与内存进行交互。

这里再顺便提一句，C语言中并非所有变量都会放在内存中。编译器可以根据不同的情况进行优化，可以将变量优化到寄存器中。对于某些编译器来说，我们也可以通过`register`关键词提示编译器，我们希望这个变量存储在寄存器中而不是内存中。

## 内存交互指令

基本的内存交互指令就是`ldr`和`str`了。

### 从内存读取数据到寄存器中

从内存读取数据的指令是`ldr`，其用法为：

```plaintext
ldr{sign}{size}    dest_reg, [mem_addr]
```
