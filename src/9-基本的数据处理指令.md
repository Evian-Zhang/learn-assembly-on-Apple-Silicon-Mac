# 基本的数据处理指令

本章将介绍一些常用的基本的数据处理指令。

我们常见的数据处理指令包括加、减、乘、除、求余、与、或、非、异或等。大部分的数据处理指令都是二元运算，也就是说，需要将两个操作数进行计算，然后赋值给第三个操作数。因此，这些二元运算指令大都有如下的形式：

```plaintext
opcode    dest, source1, source2
```

## 加、减、与、或、非、异或

首先是一些常规的、比较简单的计算：

* 加

   ```armasm
   add    dest_reg, src_reg1, src_reg2/imm
   ```
* 减

   ```armasm
   sub    dest_reg, src_reg1, src_reg2/imm
   ```
* 与

   ```armasm
   and    dest_reg, src_reg1, src_reg2/imm
   ```
* 或

   ```armasm
   orr    dest_reg, src_reg1, src_reg2/imm
   ```
* 非
   ```armasm
   mvn    dest_reg, src_reg
   ```
* 异或

   ```armasm
   eor    dest_reg, src_reg1, src_reg2/imm
   ```

值得一提的是，这些操作都没有涉及到符号。在[底层的整数](./1-底层的整数.md)一章中，我们提到，使用补码存储整数的好处就是，无论是有符号整数还是无符号整数，其加减运算都不需要区分有无符号。而对与、或、非、异或来说，这些操作都是逐位进行逻辑运算，因此在这些操作中，也不用区分有无符号。

## 乘、除、求余

* 乘

   ```armasm
   mul    dest_reg, src_reg1, src_reg2
   umull  dest_reg, src_reg1, src_reg2
   smull  dest_reg, src_reg1, src_reg2
   ```

   其中，`mul`指令的三个操作数都是32位寄存器，`umull`、`smull`的源操作数是32位寄存器，目的操作数是64位寄存器。

   `umull`代表无符号乘法，`smull`代表有符号乘法。

* 除

   ```armasm
   sdiv   dest_reg, src_reg1, src_reg2
   udiv   dest_reg, src_reg1, src_reg2
   ```

   其中，`sdiv`代表有符号除法，`udiv`代表无符号除法。

   使用这种除法得到的结果，与C语言中的除法操作类似，都是向0取整的整数。因此，对5和2进行`sdiv`，得到的是2；对-5和-2进行`sdiv`，得到的是-2。
* 求余

   A64指令集不提供直接的求余计算。如果我们想求存储有符号整数的寄存器`w1`模`w2`的余数，结果存储在`w0`中，那么，根据上面介绍的数据处理指令，我们可以这么做：

   ```armasm
   sdiv   w0, w1, w2
   mul    w0, w2, w0
   sub    w0, w1, w0
   ```

   我们可以查看本GitHub仓库`codes/`目录下的`9-div.s`文件，编译并运行它，使用`echo $?`查看结果是否符合预期。
